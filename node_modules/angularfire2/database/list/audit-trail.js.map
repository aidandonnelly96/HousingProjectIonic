{"version":3,"sources":["../../../../src/database/list/audit-trail.ts"],"names":[],"mappings":"AACA,OAAO,EAAE,YAAY,EAAE,MAAM,iBAAiB,CAAC;AAC/C,OAAO,EAAE,aAAa,EAAE,MAAM,UAAU,CAAC;AAGzC,OAAO,6BAA6B,CAAC;AACrC,OAAO,kCAAkC,CAAC;AAC1C,OAAO,uBAAuB,CAAC;AAE/B,MAAM,2BAA2B,KAAoB;IACnD,MAAM,CAAC,UAAC,MAAqB,IAAK,OAAA,UAAU,CAAC,KAAK,EAAE,MAAM,CAAC,EAAzB,CAAyB,CAAC;AAC9D,CAAC;AAED,MAAM,qBAAqB,KAAoB,EAAE,MAAqB;IACpE,IAAM,WAAW,GAAG,YAAY,CAAC,KAAK,EAAE,MAAM,CAAC;SAC5C,IAAI,CAAC,UAAC,OAAO,EAAE,MAAM,IAAK,OAAI,OAAO,SAAE,MAAM,IAAnB,CAAoB,EAAE,EAAE,CAAC,CAAC;IACvD,MAAM,CAAC,aAAa,CAAC,KAAK,EAAE,WAAW,CAAC,CAAC;AAC3C,CAAC","file":"audit-trail.js","sourceRoot":"","sourcesContent":["import { DatabaseQuery, ChildEvent, AngularFireAction, SnapshotAction } from '../interfaces';\nimport { stateChanges } from './state-changes';\nimport { waitForLoaded } from './loaded';\nimport { Observable } from 'rxjs/Observable';\nimport { database } from 'firebase/app';\nimport 'rxjs/add/operator/skipWhile';\nimport 'rxjs/add/operator/withLatestFrom';\nimport 'rxjs/add/operator/map';\n\nexport function createAuditTrail(query: DatabaseQuery) {\n  return (events?: ChildEvent[]) => auditTrail(query, events);\n}\n\nexport function auditTrail(query: DatabaseQuery, events?: ChildEvent[]): Observable<SnapshotAction[]> {\n  const auditTrail$ = stateChanges(query, events)\n    .scan((current, action) => [...current, action], []);\n  return waitForLoaded(query, auditTrail$);\n}\n"]}